datasource db {
	provider = "mysql"
	url      = env("DATABASE_URL")
}

generator client {
	provider = "prisma-client-js"
}

model User {
	id        String   @id @default(cuid())
	email     String   @unique
	name      String?
	createdAt DateTime @default(now())
	updatedAt DateTime @updatedAt
	tokens    Token[]
	files     FileMeta[]
}

model Token {
	id             String   @id @default(cuid())
	user           User     @relation(fields: [userId], references: [id])
	userId         String
	provider       String
	providerUserId String?  
	accessToken    String
	refreshToken   String?
	expiresAt      DateTime?
	scope          String?
	createdAt      DateTime @default(now())
	updatedAt      DateTime @updatedAt
	// Ensure uniqueness of provider + providerUserId when present
	@@unique([provider, providerUserId])
}

model FileMeta {
	id           String   @id @default(cuid())
	user         User     @relation(fields: [userId], references: [id])
	userId       String
	courseId     String
	canvasFileId String   @unique
	fileName     String
	downloadUrl  String
	localPath    String?
	status       String   @default("pending")
	createdAt    DateTime @default(now())
	updatedAt    DateTime @updatedAt
}
